<!-- navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light pb-3 pt-3 " id="mainNav">
    <div class="container">
      <div class="d-flex justify-content-center align-content-center">
        <h4 class="payicon ms-5 mt-1 bg-dark pt-1 pb-1 ps-2 pe-2 text-white">C</h4>
        <h4 class="  navtextpay">-Pay</h4> 
      </div>       
       <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            Menu
            <i class="fas fa-bars ms-1"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav text-uppercase ms-auto me-5 py-4 py-lg-0 ">
                <li class="nav-item"><a routerLink="/dashboard"  class="nav-link text-dark   fw-bold" >Home</a></li>
                <li class="nav-item"><a (click)="getBalance()" class="nav-link text-dark   fw-bold" data-bs-toggle="offcanvas" href="#offcanvasExample">Balance</a></li>
                <li class="nav-item"><a routerLink="/transaction" class="nav-link text-dark   fw-bold" >Transactions</a></li>
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle text-dark fw-bold" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Account
                  </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                  <!-- <a  class="dropdown-item" >Edit Account</a> -->
                  <a  class="dropdown-item " data-toggle="modal" data-target="#deleteModal">Remove Account</a>
                  <a  class="dropdown-item "  data-toggle="modal" data-target="#exampleModal">SignOut</a>
      
                </div>
                </li>
            </ul>
           
        </div>
    </div>
</nav>


  <!-- offcanvas balance enquiry -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasExampleLabel">Balance Enquiry</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <img class="canvasbalimg " src="https://static.vecteezy.com/system/resources/previews/005/866/957/non_2x/mobile-banking-modern-flat-concept-for-web-banner-design-woman-uses-mobile-application-to-pay-with-credit-card-and-accumulate-money-in-account-illustration-with-isolated-people-scene-free-vector.jpg" alt="">
    <div class="pt-4">
      <h3 class="mb-3">Hi {{currentUserDetails[0].username}}</h3>
      <h5>Your Balance is </h5>
      <h4 class="text-primary fw-bold">â‚¹ {{currentUserDetails[0].balance}}</h4>
    </div>
    
    </div>
  </div>

<!-- Header-->
<header class="hero-bg   py-5">
  <div class="container row px-4 px-lg-5 my-5">
      <div class="text-center magicpattern  text-white col-xl-6 mb-4">
        <h1 class="display-5 text-primary fw-bolder  mb-4"><span class="text-dark">Hello</span>  {{currentUserDetails[0].username}} </h1>
          <h1 class="display-5 text-dark fw-bolder  mb-4">Welcome to </h1>
          <!-- <h1 class="display-2 mb-5 fw-bolder cartifytext">  Cartify</h1> -->
          <div class="waviy pt-4">
              <span class="headerC ms-5 mt-1 bg-dark ps-4 pe-4 text-white "  style="--i:1">C</span>
              <span class="ms-3" style="--i:2">-</span>
              <span class="ms-3" style="--i:3">P</span>
              <span class="ms-3" style="--i:4">a</span>
              <span class="ms-3" style="--i:5">y</span>
              
             
           
             </div>
             <div class="pt-5">
              <h3 class=" fw-bold text-dark pt-5 mb-3 display-6">Payment and Chat <br> Made Easier</h3>
             </div>
      </div>
      <div class="col-xl-6 p-0 ">
          
              <img class="header-bg " src="https://static.vecteezy.com/system/resources/previews/005/868/074/non_2x/secure-payment-modern-flat-concept-for-web-banner-design-man-makes-online-payment-confirming-his-identity-with-fingerprint-protection-of-transactions-illustration-with-isolated-people-scene-vector.jpg" alt="">
          
      </div>
  </div>
</header>


  <!-- Users section -->
  <section id="section-user">
    <div class="container-fluid mt-5 ">
        <div class="row devpanel ">
          <h1 class="text-center text-white fw-bold  mt-5 mb-5">Connect With Users</h1>
          <div class="row mt-3">
            <div class="col-4"></div>
            <div class="col-4 ps-4">
              <h4 class="text-center text-dark fw-bold">Search Users</h4>
              <input (keyup)="search($event)" type="text" class="form-control" placeholder="Enter a Name">
            </div>
            <div class="col-4"></div>
          </div>

            <div class="col-xl-4 col-md-6 "  *ngFor="let user of  filteredUsers | filter:searchTerm:'username'; ">   <!--for loop -->  
                <div class="card mt-5 ms-2" style="border-radius: 15px;">
          <div class="card-body p-4">
            <div class="d-flex text-black">
              <div class="flex-shrink-0">
                <img [src]="user.image"
                  alt="Generic placeholder image" class="img-fluid"
                  style="width: 180px; border-radius: 10px;">
              </div>
              <div class="flex-grow-1 ms-3">
                <h4 class="mb-1 mt-5 fw-bold">{{user.username}}</h4>
                <div class="d-flex justify-content-start rounded-1 p-2 mb-2"
                  style="background-color: #efefef;">
                  
                </div>
                <div class="d-flex pt-1 mt-3">
                  <button (click)="passToAcno(user.acno)" type="button" class="btn btn-outline-primary me-1 flex-grow-1" data-bs-toggle="modal" data-bs-target="#staticBackdrop2">Chat</button>
                  <button (click)="passToAcno(user.acno) " type="button" class="btn btn-primary flex-grow-1" data-bs-toggle="modal" data-bs-target="#staticBackdrop">Pay</button>
                </div>
              </div>
            </div>
          </div>
        </div>
          
            </div>
        </div>
    </div>
</section>

<!-- modal funs transfer -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
            <img  [src]="toUserImage" alt="" width="70" height="70" class="d-inline-block align-text-top payicon ms-3">
          <h1 class="modal-title fs-2  ms-3" id="staticBackdropLabel">{{toUserName}}</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="d-flex justify-content-center">
              <!-- scrollbox -->
              <div class="overflow-auto scroll-box bg-light pt-5 ps-4 pe-4 pb-4  mb-3">
                <div *ngFor="let trans of transaction">
                    <div *ngIf="trans.fromAcno==toUserAcno" class="d-flex mt-3">
                      <img class="me-2 payfrom"  width="50" height="50" [src]="toUserImage" alt="">
                      <div  class="payfrom bg-dark p-2 w-25 text-center text-white mt-2"> {{trans.amount}}</div>

                    </div>

                    <div *ngIf="trans.fromAcno==CurrentAcnoNum && trans.toAcno==toUserAcno" class="payfrom bg-primary p-2 ms-auto w-25 text-center text-white mt-3">{{trans.amount}}</div>

                    <!-- <div class="text-dark" *ngIf="!trans.type"><h4>No Transactions Yet</h4> </div> -->
                </div>
              </div>

          </div>

          <!-- <div class=" w-100 mb-3 hr-width"></div> -->

          <form [formGroup]="fundForm">
            
            <div class="form-floating mb-3">
              <input type="text" name="amount" formControlName="amount" class="form-control" id="floatingamount" placeholder="amount">
              <label for="floatingamount">Amount</label>
              <div *ngIf="this.fundForm.get('amount')?.errors && this.fundForm.get('amount')?.touched" class="text-danger">Invalid Data</div>
            </div>
            <div class="form-floating mb-3">
              <input type="password" name="password" formControlName="password" class="form-control" id="floatingpassword" placeholder="password">
              <label for="floatingpassword">Profile Password</label>
              <div *ngIf="this.fundForm.get('password')?.errors && this.fundForm.get('password')?.touched" class="text-danger">Invalid Password</div>

            </div>
          </form>
        </div>
        <div class="text-success text-center mb-1">
            {{fundTransferSuccessMsg}}
        </div>
        <div class="text-danger text-center mb-1">
          {{fundTransferErrorMsg}}
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-danger me-auto ms-2" data-bs-dismiss="modal">Close</button>
          <button (click)="fundTransfer()" type="button" class="btn  btn-primary ms-3">Transfer<i class="ms-2 fa-solid  fa-paper-plane"></i></button>
        </div>
      </div>
    </div>
  </div>



  <!-- modal Message transfer -->
<div class="modal fade" id="staticBackdrop2" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
          <img  [src]="toUserImage" alt="" width="70" height="70" class="d-inline-block align-text-top payicon ms-3">
        <h1 class="modal-title fs-2  ms-3" id="staticBackdropLabel">{{toUserName}}</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="d-flex justify-content-center">
            <!-- scrollbox -->
            <div class="overflow-auto scroll-box bg-light pt-5 ps-4 pe-4 pb-4  mb-3">
              <div *ngFor="let c of chat">
                <!-- taking received messages -->
                  <div *ngIf="c.fromAcno==toUserAcno" class="d-flex mt-3">
                    <img class="me-2 payfrom"  width="50" height="50" [src]="toUserImage" alt="">
                    <div  class="payfrom bg-dark p-2 w-25 text-center text-white mt-2"> {{c.msg}}</div>

                  </div>
                  <!--taking sent messages - to this particular user -->
                  <div *ngIf="c.fromAcno==CurrentAcnoNum && c.toAcno==toUserAcno" class="payfrom bg-primary p-2 ms-auto w-25 text-center text-white mt-3">{{c.msg}}</div>

                  <!-- <div class="text-dark" *ngIf="!trans.type"><h4>No Transactions Yet</h4> </div> -->
              </div>
            </div>

        </div>

        <!-- <div class=" w-100 mb-3 hr-width"></div> -->

        <form [formGroup]="fundForm">
          
          <div class="form-floating mb-3">
            <input (keyup)="addMessage($event)" type="text" name="amount" formControlName="amount" class="form-control" id="floatingamount" placeholder="amount">
            <label for="floatingamount">Enter Message</label>
          </div>
         
        </form>
      </div>


      <div class="modal-footer mb-2">
        <button (click)="messageTransfer()" type="button" class="btn  btn-primary ms-3">Send<i class="ms-2 fa-solid  fa-paper-plane"></i></button>
      </div>
    </div>
  </div>
</div>



  <!-- logout Modal -->
<div class="modal " id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title text-dark fw-bold" id="exampleModalLabel">Logout</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       <h4>Are you sure you want to Logout ?</h4> 
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
        <button (click)="logout()"  type="button" class="btn btn-primary">Yes</button>
      </div>
    </div>
  </div>
</div>


    <!-- delete modal -->
<div class="modal " id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title text-dark fw-bold" id="exampleModalLabel">Delete Account</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       <h4 class="text-danger">Enter your password </h4>
       <input (keyup)="passwordPass($event)"  type="password" class="form-control " placeholder="password">
       <div *ngIf="invalidpassword" class="text-danger text-center mt-2">
        Incorrect password
      </div>      
    </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button (click)="deleteAccount()"  type="button" class="btn btn-primary">Confirm</button>
      </div>
    </div>
  </div>
</div>


<!-- options Sections -->

<div class="container options-container pt-4 ">
  <h1 class="text-center  text-dark fw-bold  mt-5 mb-5">More Options</h1>

  <div class="row">
    <div class="col-md-6 d-flex justify-content-center align-content-center p-4">
      <!-- Transaction Card -->
      <div routerLink="/transaction" class="optioncard card-1-bg   " >
        <div class="card-body ">
          <h3 class="card-title text-center fw-bold mb-3">Transaction History</h3>
          <div class="div cardsub-container pb-2" style="background-color: #f0e7ee;">
            <h4 class="card-text text-center mt-4 text-primary " >Get your Complete Transaction History  </h4>
            <h4 class="card-text mb-2 text-center  text-primary " >Sort According to Debit or Credit Details  </h4>
          </div>
        
        </div>
      </div>
    </div>
    <div class="col-md-6 d-flex justify-content-center align-content-center p-4">
            <!-- get Balance Card -->
            <div (click)="getBalance()" class="optioncard card-1-bg   " data-bs-toggle="offcanvas" href="#offcanvasExample">
              <div class="card-body ">
                <h3 class="card-title text-center fw-bold mb-3">Account Balance</h3>
                <div class="div cardsub-container pb-2" style="background-color: #f0e7ee;">
                  <h4 class="card-text text-center mt-4 text-primary " >Know your Account Balance </h4>
                  <h4 class="card-text mb-2 text-center  text-primary " >In just One Click  </h4>
                </div>
              
              </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6 d-flex justify-content-center align-content-center p-3">
       <!-- Delete Account Card -->
       <div  class="optioncard card-2-bg   " data-toggle="modal" data-target="#deleteModal">
        <div class="card-body ">
          <h3 class="card-title text-center text-white fw-bold mb-3">Delete Account</h3>
          <div class="div cardsub-container pb-2" style="background-color: #f0e7ee;">
            <h4 class="card-text text-center mt-4 card-sub-text " >Click Here </h4>
            <h4 class="card-text mb-2 text-center card-sub-text " >To Delete Your Account  </h4>
          </div>
        
        </div>
    </div>
  </div>
  <div class="col-md-6 d-flex justify-content-center align-content-center p-3">
    <div  class="optioncard card-2-bg   " data-toggle="modal" data-target="#exampleModal">
      <div class="card-body ">
        <h3 class="card-title text-center text-white fw-bold mb-3">Sign Out</h3>
        <div class="div cardsub-container pb-2" style="background-color: #f0e7ee;">
          <h4 class="card-text text-center mt-4 card-sub-text " >Click Here </h4>
          <h4 class="card-text mb-2 text-center  card-sub-text " >To Delete Your Account  </h4>
        </div>
      
      </div>
  </div>
  </div>

</div>
</div>
</div>



